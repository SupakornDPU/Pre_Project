<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Register</title>

   <!-- CSS -->
   <link rel="stylesheet" href="css/main.css">

   <!-- W3 School -->
   <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
   <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

   <!-- Bootstrap -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css">

   <style>
      .btn {
         background-color: #b29f82;
         color: white;
      }

      .btn:hover {
         background-color: #706656;
      }

      .btn:active {
         background-color: #b29f82 !important;
      }

      .form-control {
         border: 1px solid #b29f82;
      }

      .w3-bar {
         background-color: #272829;
         color: white;
      }
   </style>
</head>

<body>

   <!-- !Navbar -->
   <div class="w3-top">
      <div class="w3-bar w3-card" id="myNavbar">
         <div class="w3-large d-flex justify-content-between align-items-center text-center">
            <div class="w3-hide-small w3-hide-medium">
               <a href="index.html" class="w3-bar-item w3-button w3-wide block-logo">
                  <img src="img/LOGO.png" alt="" srcset="" class="logo-img">
               </a>
            </div>
            <div class="w3-hide-small w3-hide-medium" style="padding-left: 200px;">
               <a href="index.html" class="w3-bar-item w3-button"> HOME</a>
               <a href="#team" class="w3-bar-item w3-button"> ABOUT</a>
               <a href="#work" class="w3-bar-item w3-button"><i class="fa fa-th"></i> SERVICE POINT</a>
               <a href="#contact" class="w3-bar-item w3-button"><i class="fa fa-envelope"></i> CONTACT</a>
            </div>
            <div class="d-flex justify-content-end align-items-center">
               <div class="w3-hide-small w3-hide-medium" id="authLoginRegis">
                  <a href="login.html" class="w3-bar-item w3-button w3-wide"><i class="fa fa-user"></i>LOGIN</a>
                  <a href="register.html" class="w3-bar-item w3-button w3-wide"><i class="fa fa-user"></i>REGISTER</a>
               </div>
               <div class="w3-hide-small w3-hide-medium" id="profile" style="display: none;">
                  <a href="#" class="w3-bar-item w3-button w3-wide"><i class="fa fa-user"></i>Profile</a>
                  <a href="#" class="w3-bar-item w3-button w3-wide" id="logout"><i class="fa fa-user"></i>LOGOUT</a>
               </div>
            </div>
         </div>

         <!-- Hide right-floated links on small screens and replace them with a menu icon -->
         <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large" onclick="w3_open()">
            <i class="fa fa-bars"></i>
         </a>
      </div>
   </div>

   <!-- Sidebar on small screens when clicking the menu icon -->
   <nav class="w3-sidebar w3-bar-block w3-black w3-card w3-animate-left w3-hide-medium w3-hide-large"
      style="display:none;margin-top: -250px;" id="mySidebar">
      <a href="javascript:void(0)" onclick="w3_close()" class="w3-bar-item w3-button w3-large w3-padding-16">Close
         ×</a>
      <a href="#about" onclick="w3_close()" class="w3-bar-item w3-button">ABOUT</a>
      <a href="#team" onclick="w3_close()" class="w3-bar-item w3-button">TEAM</a>
      <a href="#work" onclick="w3_close()" class="w3-bar-item w3-button">WORK</a>
      <a href="#pricing" onclick="w3_close()" class="w3-bar-item w3-button">PRICING</a>
      <a href="#contact" onclick="w3_close()" class="w3-bar-item w3-button">CONTACT</a>
   </nav>
   <!-- !Navbar -->

   <!-- !Form Register -->
   <div class="container" style="margin-top: 250px;" id="form-area">
      <form id="registerForm">
         <div class="d-flex justify-content-center align-items-center mb-5">
            <h1 style="font-weight: 500;">CREATE ACCOUNT</h1>
         </div>

         <!-- Row EMAIL -->
         <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-4">
               <div class="form-outline mb-4">
                  <label class="mb-2" for="typeEmail">EMAIL</label>
                  <input type="email" id="typeEmail" class="form-control form-control-lg" name="email" required />
               </div>
            </div>
         </div>

         <!-- Row PASSWORD -->
         <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-4">
               <div class="form-outline mb-4">
                  <label class="mb-2" for="typePassword">PASSWORD</label>
                  <input type="password" id="typePassword" class="form-control form-control-lg" name="password"
                     required />
               </div>
            </div>
         </div>

         <!-- Row First Name -->
         <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-4">
               <div class="form-outline mb-4">
                  <label class="mb-2" for="typeFirstName">FIRST NAME</label>
                  <input type="text" id="typeFirstName" class="form-control form-control-lg" name="firstname"
                     required />
               </div>
            </div>
         </div>

         <!-- Row Last Name -->
         <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-4">
               <div class="form-outline mb-4">
                  <label class="mb-2" for="typeLastName">LAST NAME</label>
                  <input type="text" id="typeLastName" class="form-control form-control-lg" name="lastname" required />
               </div>
            </div>
         </div>

         <!-- Row Phone -->
         <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-4">
               <div class="form-outline mb-4">
                  <label class="mb-2" for="typePhone">PHONE</label>
                  <input type="text" id="typePhone" class="form-control form-control-lg" name="phone" required />
               </div>
            </div>
         </div>

         <div class="row d-flex justify-content-center align-items-center ">
            <div class="col-md-4">
               <div class="form-outline mb-4">
                  <input type="text" id="typePhone" value="0" style="display: none;" class="form-control form-control-lg" name="point"  />
               </div>
            </div>
         </div>

         <!-- Button -->
         <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-4">
               <div class="d-grid gap-2 col-md-12 mx-auto">
                  <button class="btn btn-lg btn-block" type="submit">CREATE</button>
               </div>
            </div>
         </div>
         <!-- Button -->
      </form>
   </div>
   <!-- !Form Login -->


   <!-- !Footer -->
   <footer-component></footer-component>

   <script type="module">

      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
      import { getAuth, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-auth.js";
      import { getFirestore, collection, getDocs, deleteDoc, doc ,addDoc , setDoc} from "https://www.gstatic.com/firebasejs/9.19.1/firebase-firestore.js";

      const firebaseConfig = {
         apiKey: "AIzaSyCODow7HLMRU3ik_9glYxoxjE2R6prKjq8",
         authDomain: "recycle-machine-23716.firebaseapp.com",
         projectId: "recycle-machine-23716",
         storageBucket: "recycle-machine-23716.appspot.com",
         messagingSenderId: "715253109818",
         appId: "1:715253109818:web:8dae7aa5ed3ada676e1103",
         measurementId: "G-DEQYWJ115S"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      const form = document.getElementById("registerForm");
      const authLoginRegis = document.getElementById("authLoginRegis");
      const profile = document.getElementById("profile");
      const logout = document.getElementById("logout");

      form.addEventListener("submit", (e) => {
         e.preventDefault();
         const email = form.email.value;
         const password = form.password.value;
         const User_Firstname = form.firstname.value;
         const User_Lastname = form.lastname.value;
         const User_Tel = form.phone.value;
         const User_Point = form.point.value;
         const deleted = false;
         createUserWithEmailAndPassword(auth, email, password,User_Firstname,User_Lastname,User_Tel,User_Point)
            .then(async (result) => {
               console.log(result.user);
               const ref = doc(db,"user",result.user.uid);
               const docRef = await setDoc(ref,{email,User_Firstname,User_Lastname,User_Tel,User_Point,deleted});
               swal.fire({
                  title: "สมัครสมาชิกสำเร็จ",
                  icon: "success",
                  showConfirmButton: false,
                  timer: 800
               }).then(() => {
                  window.location.href = "index.html";
               });
            }).catch((err) => {
               swal.fire({
                  title: "สมัครสมาชิกไม่สำเร็จ",
                  icon: "error",
                  showConfirmButton: false,
                  timer: 800
               }).then(() => {
                  window.location.href = "register.html";
               });
            });
      });

      onAuthStateChanged(auth, (user) => {
         if (user) {
            profile.style.display = "block";
            authLoginRegis.style.display = "none";
         } else {
            profile.style.display = "none";
            authLoginRegis.style.display = "block";
         }
      });

      logout.addEventListener("click", (e) => {
         signOut(auth)
            .then(() => {
               swal.fire({
                  title: "ออกจากระบบสำเร็จ",
                  icon: "success",
                  showConfirmButton: false,
                  timer: 1500
               })
            }).catch((err) => {
               swal.fire({
                  title: "ออกจากระบบไม่สำเร็จ",
                  icon: "error",
                  showConfirmButton: false,
                  timer: 1500
               })
            });
      })
   </script>

   <!-- SCRIPT -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"></script>
   <script src="component/component.js"></script>

   <!-- Sweetalert -->
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>